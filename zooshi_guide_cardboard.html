<!-- HTML header for doxygen 1.8.6-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>Zooshi: Cardboard</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400italic,500,500italic,700,700italic|Roboto+Mono:400,700" rel="stylesheet">
<link href="style.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="commonprojectlogo">
    <img alt="Logo" src="fpl_logo_small.png"/>
  </td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">Zooshi
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="zooshi_guide_gameplay.html"><span>Gameplay</span></a></li>
      <li><a href="zooshi_guide_overview.html"><span>Programmer's&#160;Guide</span></a></li>
      <li><a href="zooshi_readme.html"><span>Readme</span></a></li>
      <li><a href="contributing.html"><span>Contributing</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('zooshi_guide_cardboard.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Cardboard </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="cardboard_introduction"></a>
Introduction</h1>
<p>This document outlines how the <a href="https://developers.google.com/cardboard/android/">Cardboard SDK for Android</a> is used in <a class="el" href="index.html#zooshi_index">Zooshi</a>, through the wrapper provided by <a href="https://google.github.io/fplbase/">fplbase</a>. For additional tips on designing for Cardboard, be sure to check out <a href="http://www.google.com/design/spec-vr/designing-for-google-cardboard/a-new-dimension.html">Designing for Google Cardboard</a>.</p>
<h1><a class="anchor" id="cardboard_overview"></a>
Overview</h1>
<p>The Cardboard SDK provides various interfaces and classes to handle the information that is needed to work with a Cardboard device, like head tracking and detecting the magnet switch input. To simplify the interaction with the SDK, fplbase provides various helper functions and an abstraction layer for managing the transformations, which Zooshi takes advantage of.</p>
<h1><a class="anchor" id="cardboard_input"></a>
Input</h1>
<p>Input from the Cardboard SDK, which includes the orientation of the device, as well as both detecting the magnet switch or screen touches, is used in the <b>AndroidCardboardController</b> (android_cardboard_controller.h/.cpp). Note that this controller is used not only in Cardboard mode, but also regular play on Android devices that support the Cardboard SDK.</p>
<p>When updating, the controller uses the <b>HeadMountedDisplayInput</b> class, provided by fplbase's <b>InputSystem</b>, which contains information about device orientation, and if the Cardboard trigger was detected in the last frame.</p>
<p>Zooshi uses a coordinate system where Z is treated as up, with Y being forward, while the Cardboard SDK and fplbase's wrapper class, treat Y as up, with Z being forward. However, this change in coordinate systems is easy to handle, by just converting the values before use.</p>
<h1><a class="anchor" id="cardboard_rendering"></a>
Rendering</h1>
<p>Rendering for Cardboard has to be handled, as the view needs to be duplicated for the left and right eye. Along with that, the Cardboard SDK provides the function <code>undistortTexture()</code> in <a href="https://developers.google.com/cardboard/android/latest/reference/com/google/vrtoolkit/cardboard/CardboardView">CardboardView</a>, which undistorts the given texture, adjusting the image to make it look correct for cardboard.</p>
<p>fplbase's <b>Mesh</b> class provides a function that enables rendering for multiple viewports, <code>RenderStereo(...)</code>. Zooshi uses this through the <b>RenderMesh</b> component, from <a href="https://google.github.io/corgi">CORGI</a>'s <a href="http://google.github.io/corgi/component_library.html">component library</a>, with the extra setup necessary occuring in states/states_common.cpp, <code>RenderStereoscopic()</code>. This handles rendering the same mesh from the slightly different transforms needed for Cardboard to display correctly.</p>
<p>To use the screen undistortion effects, fplbase provides wrapper functions to call before and after rendering the world, <b>HeadMountedDisplayRenderStart</b> and <b>HeadMountedDisplayRenderEnd</b>. These calls should wrap any rendering that is meant to be seen with both eyes, and can be seen in use in the same <code>RenderStereoscopic()</code> function as above.</p>
<p><br/>
 </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- Google Analytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-46159502-1', 'google.github.io');
ga('send', 'pageview');
</script>
</body>
</html>
